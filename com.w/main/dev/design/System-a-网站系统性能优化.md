# 网站系统性能优化

## 性能测试

### 用户

响应

### 开发

延迟，吞吐，并发，稳定

### 运维

资源利用率

### 测试指标

- 响应时间
- 并发数
- 吞吐量
- 性能计数器

### 测试方法

- 性能测试
- 负载测试
- 压力测试
- 稳定性测试

## 前端优化

### 浏览器访问优化

1. 减少Http请求
2. 浏览器缓存
3. 启用压缩
4. CSS优于JavaScript加载 {加载完CSS渲染，加载JS就执行}

### CDN加速

### 反向代理

## 应用服务器优化

### 分布式缓存

1. Hash缓存定位

2. 合理使用缓存

    - 频繁修改的数据
    - 没有热点的访问
    - 数据不一致的脏读
    - 缓存可用性
    - 缓存预热

3. 分布式缓存架构

    1. JBoss
    2. Memached
        - 通信简单
        - 丰富的客户端程序
        - 高性能通信网络
        - 高效内存管理
        - 互不通信的服务集群架构

4. 异步

5. 代码优化

    - 多线程

        解决线程安全：对象设计为无状态，使用局部对象，并发访问资源时使用锁

    - 资源复用

        单例，对象池

    - 数据结构

    - 垃圾回收

## 存储性能优化

1. 硬件

    机械硬盘，固态硬盘

2. 数据结构

    B+树

    LSM树：更新内存中使用，不必读取磁盘，远快于B+树

3. RAIDvsHDFS

    - RAID：并发读写和数据备份
        - RAID0：数据写入磁盘分为N份，并发写入磁盘
        - RAID1：一份数据写入两块磁盘
        - RAID10：磁盘分为2份，每一份中采用RAID1中的策略
        - RAID3：数据分为N-1份，并在第N块磁盘上记录校验数据
        - RAID5：数据螺旋式写入所有磁盘中
        - RAID6：数据写入N-2块，在两块磁盘中螺旋式写入校验数据
    - HDFS以块管理数据，以块为单位，当一块写完即可开始同步，基于并发框架可以并发执行