# 存储引擎

> 存储引擎基于表，而不是基于数据库

# 基础概念

- 数据库：文件的集合（物理磁盘文件+其他类型文件）
- 实例：运行于内存中的（线程+线程共享内存区域）

关系：1 to 1，集群模式下例外

MySQL单进程多线程

## 存储引擎概览

### InnoDB

面向：在线事务处理应用OLTP

5.8.8之后为默认存储引擎

**特点**：行锁设计，支持外键

高并发性基础：MVCC

隔离级别：REPEATABLE，采用next-key locking避免幻读

其他：插入缓冲，二次写，自适应hash索引，预读

索引类型：聚簇，以ID主键作为基础顺序排序，若不存在指定主键，则为每一行生成一个ROWID作为主键

### MyISAM

面向：OLAP应用

**特点**：不支持事务，表锁，支持全文索引，缓冲池只缓冲索引文件

5.8.8之前默认存储引擎

构成：MYD（数据文件） + MYI（索引文件）

### NDB

面向：集群存储引擎

特点：数据全在内存中（5.1之后非索引数据可存放在磁盘）

待优化：JOIN操作在数据库层面完成，不是在存储引擎层面完成

### Memory

面向：临时数据，临时表

特点：数据存储在内存中，变长字段使用定长存储，不支持TEXT，BLOB类型

锁：只支持表锁

索引：采用hash索引

使用：MySQL使用此存储引擎作为查询中间结果集，当列类型有TEXT，BLOB时会转换到MyISAM存储引擎中存储到磁盘

### Archive

面向：高速插入，压缩功能

特点：只支持INSERT和SELECT操作，5.1开始支持索引，数据行压缩存储（zlib算法，压缩率10:1）

锁：行锁，非事务安全

### Federated

面向：远程数据库引用

特点：本身不存放数据，指向远程的数据库服务器的表

### Maria

面向：MyISAM的取代版本

特点：支持数据、索引文件缓存

锁：行锁

事务：提供MVCC，支持事务和非事务的安全选项

提供更好BLOB字符类型的处理性能

查看命令：show engines

## MySQL 连接

- tcp/ip
- 管道命名、共享内存
- UNIX域套接字
