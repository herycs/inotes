# 架构

## 垂直架构

复杂应用维护成本变高，部署效率逐渐降低

团队协作效率差，公有模块重复开发

系统可靠性变差，大流量，高并发导致容易雪崩

维护和定值困难，业务代码膨胀

新功能上线周期变长

## RPC

简单：语义明确简单，更加易于建立分布式计算

高效：过程调用看起来十分简单而且高效

通用：单机计算过程往往是不同算法和API，通用的通信机制

核心技术点：

- 远程服务提供者需要以某种形式提供服务调用相关信息
- 远程代理对象：服务调用者调用的服务实质上是远程服务的本地代理
- 通信：RPC框架与具体协议无关
- 序列化：对象的传输

## SOA

粗粒度、松耦合

特点：

- 服务可重用
- 服务共享标准契约
- 服务松耦合
- 服务是底层逻辑的抽象
- 服务是可组合的、可编排的
- 服务是自治的
- 服务是无状态的
- 服务是可被自动发现的

## 微服务

SOA解决了应用服务化，业务深入后，服务规模越来越大，治理困难越来越大

微服务特征：

- 原子服务，专注于一件事，“单一职责原则”
- 高密度部署：重要服务可独立进程部署
- 敏捷交付：小团队开发维护，真正的DevOps
- 微自治：服务足够小，功能单一，可独立打包，部署，升级，回滚和弹性伸缩，不依赖其他服务，实现局部自治

## SOA&微服务

| 项目         | SOA                            | 微服务                                                       |
| ------------ | ------------------------------ | ------------------------------------------------------------ |
| 服务拆分粒度 | 异构应用服务化                 | 服务拆分尽可能小                                             |
| 服务依赖     | 需要重用已有资产，存在大量依赖 | 服务自治，功能单一独立                                       |
| 服务规模     | 粒度大，多个服务一个war包      | 粒度小，尽可能独立部署                                       |
| 架构差异     |                                | 模块增加，通信保障力度需要提高                               |
| 服务治理     | 静态治理                       | 动态治理                                                     |
| 敏捷交付     |                                | 小团队负责，设计、开发、测试、部署、线上治理，灰度发布和下线 |

## 各种架构

MVC：应用小

RPC：垂直应用增多

SOA：业务增加，服务数量增多，服务生命周期管理，动态运行治理成为瓶颈

微服务：敏捷开发、持续交付，DevOps