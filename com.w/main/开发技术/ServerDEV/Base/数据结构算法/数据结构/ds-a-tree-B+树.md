# B+树

> 对应文件系统而产生的B树的变形

## B+树特征

- 有k个子树的中间结点包含有k个元素（B树中是k-1个元素），每个元素不保存数据，只用来**索引**；
- 所有的**叶子结点**中包含了**全部关键字**的信息，及指向含有这些关键字**记录的指针**，且叶子结点本身依关键字的大小自小而大的顺序链接。 (而B树的叶子结点并没有包括全部需要查找的信息)；
- 所有的非终端结点可以看成是索引部分，结点中仅含有其子树根结点中最大（或最小）关键字。 (而B 树的非终结点也包含需要查找的有效信息)；

## 对B树的升级

1. 磁盘读写代价低

    内部结点只有索引，同样的存储空间存储的结点信息更多，磁盘读取时可使用更少的IO

2. 查询效率稳定

    只有叶子结点才有数据，故查询都得走到叶子结点去获取信息。

3. 适合于范围查找

    数据库而言精确查找是少数，更多的是范围查找，B+树的最终数据信息都在叶子结点，故若要遍历整个树只需要遍历叶子结点即可，范围查找相对于B树而言B+树更加的适合。

## 变化

### 分裂

当一个结点满时，分配一个新的结点，并将原结点中1/2的数据复制到新结点，最后在父结点中增加新结点的指针；B+树的分裂只影响原结点和父结点，而不会影响兄弟结点

## 操作

### 查找

范围查找采用链表，一般会维护一个将所有叶子结点数据连接起来的结点

### 删除

删除后维护树的结构保证树符合基础定义

### 插入

插入后维护树的结构，使其符合B+树的基础定义

## 拓展

- 在数据库的聚集索引（Clustered Index）中，叶子结点直接包含数据。

- 在非聚集索引（NonClustered Index）中，叶子结点带有是数据的指针。

## 应用

MySQL数据库采用B+树，B树的范围查找需要遍历树，B+树只需要遍历叶子节点